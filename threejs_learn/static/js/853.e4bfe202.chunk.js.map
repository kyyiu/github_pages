{"version":3,"file":"static/js/853.e4bfe202.chunk.js","mappings":"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","sources":["webpack://three/./src/practice/interactive/drawOnCanvas.module.css?2ad2","practice/interactive/drawOnCanvas.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"canvas0\":\"drawOnCanvas_canvas0__WvxQj\",\"canvas1\":\"drawOnCanvas_canvas1__6Hiee\",\"canvas2\":\"drawOnCanvas_canvas2__VgEc2\",\"canvas3\":\"drawOnCanvas_canvas3__pBRBE\",\"canvas4\":\"drawOnCanvas_canvas4__H9-RI\",\"canvas5\":\"drawOnCanvas_canvas5__w8lmw\"};","import React, { useEffect, useRef } from \"react\";\r\nimport * as Three from 'three'\r\nimport {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\r\nimport styles from './drawOnCanvas.module.css'\r\nconst sence = new Three.Scene()\r\nconst camera = new Three.PerspectiveCamera(\r\n    45,\r\n    window.innerWidth/window.innerHeight,\r\n    0.1,\r\n    1000\r\n)\r\n\r\ncamera.position.set(0,0,700)\r\nsence.add(camera)\r\n\r\nconst renderer = new Three.WebGLRenderer({antialias: false})\r\nrenderer.setClearColor(new Three.Color(0x000000))\r\nrenderer.setSize(window.innerWidth, window.innerHeight)\r\nlet startPosition = new Three.Vector2() // 存放开始坐标二维位置\r\nlet mesh = new Array(6) // 球体\r\nlet mixer\r\nlet paint = false // 画笔移动标志位\r\nlet moveFlag = false // 鼠标移动标志\r\nlet drawingCanvas = new Array(6) // canvas对象数组\r\nlet rgbV3Arr = new Array(6)\r\nlet mousePoint = new Three.Vector2()\r\nlet axis = [] // 新建容器\r\nlet ray// 射线拾取\r\nlet canvas = new Array(6) // canvas 2d context 数组 ，\r\nlet material = new Array(6) // 纹理\r\nlet mounted = false\r\nexport default function() {\r\n    const container = useRef()\r\n  \r\n    useEffect(() => {\r\n      window.addEventListener( 'resize', onWindowResize, false );//窗口变化监听\r\n      addControls()\r\n      addLight()\r\n      addSupport()\r\n      addMesh()\r\n      canvasDrawing()\r\n      container.current.appendChild(renderer.domElement)\r\n      refresh()\r\n    }, [])\r\n\r\n    function addControls() {\r\n      const controls = new OrbitControls(camera, renderer.domElement)\r\n      // 设置阻尼，让控制器更真实, 必须在动画循环调用update方法\r\n      controls.enableDamping = true \r\n      // controls.addEventListener('change', )\r\n      controls.minDistance = 3\r\n      controls.maxDistance = 1000\r\n      controls.enablePan = true // 是否可以平移\r\n      controls.zoomSpeed = 3.0 // 设置缩放比例\r\n      controls.addEventListener(\"change\", function() {\r\n        moveFlag = true // 鼠标移动物体， 标志修改\r\n      })\r\n      container.current.addEventListener('mousedown', function() {\r\n        moveFlag=false // 鼠标点击\r\n      })\r\n      container.current.addEventListener('mouseup', function() {\r\n        mouseCollect()\r\n      })\r\n      setTimeout(() => {\r\n        container.current.addEventListener('mousemove', mouseMove)\r\n        container.current.addEventListener('touchmove', mouseMove)\r\n      }, 70);\r\n    }\r\n    function mouseMove(e) {\r\n      if (!mesh) {\r\n        return\r\n      }\r\n      let x, y\r\n      // 获得移动设备的触摸改变的值\r\n      if (e.changedTouches) {\r\n        x = e.changedTouches[ 0 ].pageX;//获得x坐标\r\n        y = e.changedTouches[ 0 ].pageY;//获得y坐标\r\n      } else {\r\n        x = e.clientX;//获得鼠标的x坐标\r\n        y = e.clientY;//获得y坐标\r\n      }\r\n      mousePoint.x = (x / window.innerWidth) * 2 -1 //转变为笛卡尔坐标\r\n      mousePoint.y = -(y / window.innerHeight) *2 +1\r\n    }\r\n    function addLight() {\r\n      const spotLight = new Three.SpotLight('0xffffff')\r\n      spotLight.position.set(camera.position)\r\n      sence.add(spotLight)\r\n      const ambientLight = new Three.AmbientLight(0x404040)\r\n      sence.add(ambientLight)\r\n    }\r\n\r\n    function getColor() {\r\n      var colorElements = \"0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f\";\r\n      var colorArray = colorElements.split(\",\");\r\n      var color =\"#\";\r\n      for(var i =0;i<6;i++){\r\n          color+=colorArray[Math.floor(Math.random()*16)];\r\n      }\r\n      return color;\r\n    }\r\n    //获取对应的canvas 并将其作为纹理图添加进对应材质中\r\n    function canvasDrawing() {\r\n      for (let i = 0; i<6;i++) {\r\n        drawingCanvas[i] = document.getElementById('canvas'+i)\r\n        canvas[i] = drawingCanvas[i].getContext('2d')\r\n        canvas[i].fillStyle = rgbV3Arr[i];\r\n        canvas[i].fillRect( 0, 0, 256, 256 );\r\n        material[i].map = new Three.Texture( drawingCanvas[i] );\r\n        //更新纹理图时自动获取canvas内容\r\n        material[i].map.needsUpdate = true;\r\n      }\r\n    }\r\n    function addMesh() {\r\n      const meshLength = 200\r\n      for(let i = 0;i<material.length; i++) {\r\n        rgbV3Arr[i] = getColor()\r\n        material[i] = new Three.MeshBasicMaterial({color: rgbV3Arr[i]})\r\n        material[i].side = Three.DoubleSide\r\n        mesh[i] = new Three.Mesh(new Three.PlaneGeometry(meshLength, meshLength), material[i])\r\n      }\r\n      mesh[0].position.x=0;\r\n      mesh[0].position.y=0;\r\n      mesh[0].position.z=0;\r\n      mesh[0].name='0';\r\n      sence.add(mesh[0]);\r\n      mesh[1].position.x=0;\r\n      mesh[1].position.y=0;\r\n      mesh[1].position.z=-200;\r\n      mesh[1].name='1';\r\n      sence.add(mesh[1]);\r\n      mesh[3].rotation.x=-Math.PI/2;\r\n      mesh[3].position.x=0;\r\n      mesh[3].position.y=100;\r\n      mesh[3].position.z=-100;\r\n      mesh[3].name='3';\r\n      sence.add(mesh[3]);\r\n      mesh[4].rotation.x=-Math.PI/2;\r\n      mesh[4].position.x=0;\r\n      mesh[4].position.y=-100;\r\n      mesh[4].position.z=-100;\r\n      mesh[4].name='4';\r\n      sence.add(mesh[4]);\r\n      mesh[5].rotation.y=-Math.PI/2;\r\n      mesh[5].position.x=-100;\r\n      mesh[5].position.y=0;\r\n      mesh[5].position.z=-100;\r\n      mesh[5].name='5';\r\n      sence.add(mesh[5]);\r\n      mesh[2].rotation.y=-Math.PI/2;\r\n      mesh[2].position.x=100;\r\n      mesh[2].position.y=0;\r\n      mesh[2].position.z=-100;\r\n      mesh[2].name='2';\r\n      sence.add(mesh[2]);\r\n    }\r\n    function addSupport() {\r\n      ray = new Three.Raycaster()\r\n    }\r\n    function mouseCollect() {\r\n      ray.setFromCamera(mousePoint, camera)\r\n      const interSection = ray.intersectObjects(sence.children)\r\n      setTimeout(() => {\r\n        if (interSection.length > 0) {\r\n          const name = interSection[0].object.name\r\n          canvasChange(name) // 变更canvas，改变当前展示的canvas\r\n          drawingCanvas[name].addEventListener('mousedown', function(e) {\r\n            paint = true\r\n            startPosition.set(e.offsetX, e.offsetY)\r\n          })\r\n          // canvas中鼠标移动监听\r\n          drawingCanvas[name].addEventListener('mousemove', function(e) {\r\n            if (paint) {\r\n              draw(canvas[name], e.offsetX, e.offsetY, (name))\r\n            }\r\n          })\r\n          // 鼠标up监听, 更改画画状态\r\n          drawingCanvas[name].addEventListener('mouseup', function(e) {\r\n            paint = false\r\n          })\r\n          // 鼠标离开canvas\r\n          drawingCanvas[name].addEventListener('mouseleave', function(e) {\r\n            paint = false\r\n          })\r\n        }\r\n      }, 100);\r\n    }\r\n    function draw(drawContext, x, y,i) {\r\n      drawContext.moveTo(startPosition.x, startPosition.y)\r\n      drawContext.strokeStyle = '#000000'\r\n      drawContext.lineTo(x, y)\r\n      drawContext.stroke()\r\n      startPosition.set(x, y)\r\n      material[i].map.needsUpdate = true // 更新纹理\r\n    }\r\n    function canvasChange(name) {\r\n      for (let i = 0;i<6;i++) {\r\n        if (name != i) {\r\n          document.getElementById(\"canvas\"+i).style.display = 'none'\r\n        } else {\r\n          document.getElementById(\"canvas\"+name).style.display = 'block'\r\n        }\r\n      }\r\n    }\r\n\r\n    function onWindowResize() {\r\n      const width = window.innerWidth;\r\n      const height = window.innerHeight;\r\n\r\n      camera.aspect = width / height;//获得当前摄像机缩放比\r\n      camera.updateProjectionMatrix();//更新矩阵\r\n      renderer.setSize( width, height );\r\n    }\r\n\r\n    function refresh(time) {\r\n      renderer.render(sence, camera)\r\n      window.requestAnimationFrame(refresh)\r\n    }\r\n  \r\n    return <div>\r\n      <canvas className={styles.canvas0} id=\"canvas0\" height=\"256\" width=\"256\"></canvas>\r\n      <canvas className={styles.canvas1} id=\"canvas1\" height=\"256\" width=\"256\"></canvas>\r\n      <canvas className={styles.canvas2} id=\"canvas2\" height=\"256\" width=\"256\"></canvas>\r\n      <canvas className={styles.canvas3} id=\"canvas3\" height=\"256\" width=\"256\"></canvas>\r\n      <canvas className={styles.canvas4} id=\"canvas4\" height=\"256\" width=\"256\"></canvas>\r\n      <canvas className={styles.canvas5} id=\"canvas5\" height=\"256\" width=\"256\"></canvas>\r\n      <div ref={container}></div>\r\n    </div>\r\n  }"],"names":["sence","Three","camera","window","innerWidth","innerHeight","position","set","add","renderer","antialias","setClearColor","setSize","ray","startPosition","mesh","Array","paint","drawingCanvas","rgbV3Arr","mousePoint","canvas","material","container","useRef","mouseMove","e","x","y","changedTouches","pageX","pageY","clientX","clientY","getColor","colorArray","split","color","i","Math","floor","random","onWindowResize","width","height","aspect","updateProjectionMatrix","refresh","time","render","requestAnimationFrame","useEffect","addEventListener","controls","OrbitControls","domElement","enableDamping","minDistance","maxDistance","enablePan","zoomSpeed","current","setFromCamera","interSection","intersectObjects","children","setTimeout","length","name","object","document","getElementById","style","display","canvasChange","offsetX","offsetY","drawContext","moveTo","strokeStyle","lineTo","stroke","map","needsUpdate","mouseCollect","addControls","spotLight","ambientLight","addLight","meshLength","side","z","rotation","PI","addMesh","getContext","fillStyle","fillRect","canvasDrawing","appendChild","_jsxs","_jsx","className","styles","id","ref"],"sourceRoot":""}